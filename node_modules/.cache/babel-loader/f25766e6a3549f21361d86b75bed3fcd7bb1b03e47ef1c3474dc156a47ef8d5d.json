{"ast":null,"code":"var _jsxFileName = \"/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\nimport SearchBar from \"./SearchBar\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  TabPane\n} = Tabs;\nfunction Home(props) {\n  _s();\n  const [posts, setPost] = useState([]);\n  const [activeTab, setActiveTab] = useState(\"image\");\n  const [searchOption, setSearchOption] = useState({\n    type: SEARCH_KEY.all,\n    keyword: \"\"\n  });\n  useEffect(() => {\n    fetchPost(searchOption);\n  }, [searchOption]);\n  const fetchPost = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    let url = \"\";\n    if (type === SEARCH_KEY.all) {\n      url = `${BASE_URL}/search`;\n    } else if (type === SEARCH_KEY.user) {\n      url = `${BASE_URL}/search?user=${keyword}`;\n    } else {\n      url = `${BASE_URL}/search?keywords=${keyword}`;\n    }\n    const opt = {\n      method: \"GET\",\n      url: url,\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n      }\n    };\n    axios(opt).then(res => {\n      if (res.status === 200) {\n        setPost(res.data);\n      }\n    }).catch(err => {\n      message.error(\"Load failed. Please Try later!\");\n      console.log(\"fetch posts failed: \", err.message);\n    });\n  };\n  const renderPosts = type => {\n    if (!posts || posts.length === 0) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"No data!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 13\n      }, this);\n    }\n    if (type === \"image\") {\n      const imageArr = posts.filter(item => item.type === \"image\").map(image => {\n        return {\n          src: image.url,\n          user: image.user,\n          caption: image.message,\n          thumbnail: image.url,\n          thumbnailWidth: 300,\n          thumbnailHeight: 200\n        };\n      });\n      return /*#__PURE__*/_jsxDEV(PhotoGallery, {\n        images: imageArr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 10\n      }, this);\n    } else if (type === \"video\") {\n      return /*#__PURE__*/_jsxDEV(Row, {\n        gutter: 32,\n        children: posts.filter(post => post.type === \"video\").map(post => /*#__PURE__*/_jsxDEV(Col, {\n          span: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            src: post.url,\n            controls: true,\n            className: \"video-block\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [post.user, \": \", post.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 15\n          }, this)]\n        }, post.url, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 7\n      }, this);\n    }\n  };\n  const operations = /*#__PURE__*/_jsxDEV(Button, {\n    children: \"Upload\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(SearchBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 6\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"display\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        onChange: key => setActiveTab(key),\n        defaultActiveKey: \"image\",\n        activeKey: activeTab,\n        tabBarExtraContent: operations,\n        children: [/*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Images\",\n          children: renderPosts(\"image\")\n        }, \"image\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 10\n        }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Videos\",\n          children: renderPosts(\"video\")\n        }, \"video\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 10\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 8\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 6\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 4\n  }, this);\n}\n_s(Home, \"wsMVT9R1VOpXPqcRFgod5krxwG0=\");\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useState","useEffect","Tabs","message","Row","Col","Button","axios","SearchBar","SEARCH_KEY","BASE_URL","TOKEN_KEY","PhotoGallery","jsxDEV","_jsxDEV","TabPane","Home","props","_s","posts","setPost","activeTab","setActiveTab","searchOption","setSearchOption","type","all","keyword","fetchPost","option","url","user","opt","method","headers","Authorization","localStorage","getItem","then","res","status","data","catch","err","error","console","log","renderPosts","length","children","fileName","_jsxFileName","lineNumber","columnNumber","imageArr","filter","item","map","image","src","caption","thumbnail","thumbnailWidth","thumbnailHeight","images","gutter","post","span","controls","className","operations","onChange","key","defaultActiveKey","activeKey","tabBarExtraContent","tab","_c","$RefreshReg$"],"sources":["/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\n\nimport SearchBar from \"./SearchBar\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\nimport PhotoGallery from \"./PhotoGallery\"\n\nconst { TabPane } = Tabs;\n\nfunction Home(props) {\n const [posts, setPost] = useState([]);\n const [activeTab, setActiveTab] = useState(\"image\");\n const [searchOption, setSearchOption] = useState({\n   type: SEARCH_KEY.all,\n   keyword: \"\"\n });\n\n useEffect(() => {\n   fetchPost(searchOption);\n }, [searchOption]);\n\n const fetchPost = (option) => {\n   const { type, keyword } = option;\n   let url = \"\";\n\n   if (type === SEARCH_KEY.all) {\n     url = `${BASE_URL}/search`;\n   } else if (type === SEARCH_KEY.user) {\n     url = `${BASE_URL}/search?user=${keyword}`;\n   } else {\n     url = `${BASE_URL}/search?keywords=${keyword}`;\n   }\n\n   const opt = {\n     method: \"GET\",\n     url: url,\n     headers: {\n       Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n     }\n   };\n\n   axios(opt)\n     .then((res) => {\n       if (res.status === 200) {\n         setPost(res.data);\n       }\n     })\n     .catch((err) => {\n       message.error(\"Load failed. Please Try later!\");\n       console.log(\"fetch posts failed: \", err.message);\n     });\n };\n\n const renderPosts = (type) => {\n   if (!posts || posts.length === 0) {\n     return <div>No data!</div>;\n   }\n   if (type === \"image\") {\n    const imageArr = posts\n    .filter((item) => item.type === \"image\")\n    .map((image) => {\n      return {\n        src: image.url,\n        user: image.user,\n        caption: image.message,\n        thumbnail: image.url,\n        thumbnailWidth: 300,\n        thumbnailHeight: 200\n      };\n    });\n\n  return <PhotoGallery images={imageArr} />;\n   } else if (type === \"video\") {\n    return (\n      <Row gutter={32}>\n        {posts\n          .filter((post) => post.type === \"video\")\n          .map((post) => (\n            <Col span={8} key={post.url}>\n              <video src={post.url} controls={true} className=\"video-block\" />\n              <p>\n                {post.user}: {post.message}\n              </p>\n            </Col>\n          ))}\n      </Row>\n    );\n  }\n };\n\n const operations = <Button>Upload</Button>;\n return (\n   <div className=\"home\">\n     <SearchBar />\n     <div className=\"display\">\n       <Tabs\n         onChange={(key) => setActiveTab(key)}\n         defaultActiveKey=\"image\"\n         activeKey={activeTab}\n         tabBarExtraContent={operations}\n       >\n         <TabPane tab=\"Images\" key=\"image\">\n           {renderPosts(\"image\")}\n         </TabPane>\n         <TabPane tab=\"Videos\" key=\"video\">\n           {renderPosts(\"video\")}\n         </TabPane>\n       </Tabs>\n     </div>\n   </div>\n );\n}\n\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}