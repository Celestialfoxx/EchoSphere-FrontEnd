{"ast":null,"code":"var _jsxFileName = \"/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\nimport SearchBar from \"./SearchBar\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  TabPane\n} = Tabs;\nfunction Home(props) {\n  _s();\n  const [posts, setPost] = useState([]);\n  const [activeTab, setActiveTab] = useState(\"image\");\n  const [searchOption, setSearchOption] = useState({\n    type: SEARCH_KEY.all,\n    keyword: \"\"\n  });\n  const handleSearch = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    setSearchOption({\n      type: type,\n      keyword: keyword\n    });\n  };\n  useEffect(() => {\n    fetchPost(searchOption);\n  }, [searchOption]);\n  const fetchPost = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    let url = \"\";\n    if (type === SEARCH_KEY.all) {\n      url = `${BASE_URL}/search`;\n    } else if (type === SEARCH_KEY.user) {\n      url = `${BASE_URL}/search?user=${keyword}`;\n    } else {\n      url = `${BASE_URL}/search?keywords=${keyword}`;\n    }\n    const opt = {\n      method: \"GET\",\n      url: url,\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n      }\n    };\n    axios(opt).then(res => {\n      if (res.status === 200) {\n        setPost(res.data);\n      }\n    }).catch(err => {\n      message.error(\"Load failed. Please Try later!\");\n      console.log(\"fetch posts failed: \", err.message);\n    });\n  };\n  const renderPosts = type => {\n    if (!posts || posts.length === 0) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"No data!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 14\n      }, this);\n    }\n    if (type === \"image\") {\n      const imageArr = posts.filter(item => item.type === \"image\").map(image => {\n        return {\n          src: image.url,\n          user: image.user,\n          caption: image.message,\n          thumbnail: image.url,\n          thumbnailWidth: 300,\n          thumbnailHeight: 200\n        };\n      });\n      return /*#__PURE__*/_jsxDEV(PhotoGallery, {\n        images: imageArr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 14\n      }, this);\n    } else if (type === \"video\") {\n      return /*#__PURE__*/_jsxDEV(Row, {\n        gutter: 32,\n        children: posts.filter(post => post.type === \"video\").map(post => /*#__PURE__*/_jsxDEV(Col, {\n          span: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            src: post.url,\n            controls: true,\n            className: \"video-block\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"This is a test video from \", post.user, \": \", post.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 17\n          }, this)]\n        }, post.url, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this);\n    }\n  };\n  const operations = /*#__PURE__*/_jsxDEV(Button, {\n    children: \"+New Post\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 22\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n      handleSearch: handleSearch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"display\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        onChange: key => setActiveTab(key),\n        defaultActiveKey: \"image\",\n        activeKey: activeTab,\n        tabBarExtraContent: operations,\n        children: [/*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Images\",\n          children: renderPosts(\"image\")\n        }, \"image\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Videos\",\n          children: renderPosts(\"video\")\n        }, \"video\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n_s(Home, \"pedKkla1JPEx3uwuJYa39epdhRE=\");\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useState","useEffect","Tabs","message","Row","Col","Button","axios","SearchBar","SEARCH_KEY","BASE_URL","TOKEN_KEY","PhotoGallery","jsxDEV","_jsxDEV","TabPane","Home","props","_s","posts","setPost","activeTab","setActiveTab","searchOption","setSearchOption","type","all","keyword","handleSearch","option","fetchPost","url","user","opt","method","headers","Authorization","localStorage","getItem","then","res","status","data","catch","err","error","console","log","renderPosts","length","children","fileName","_jsxFileName","lineNumber","columnNumber","imageArr","filter","item","map","image","src","caption","thumbnail","thumbnailWidth","thumbnailHeight","images","gutter","post","span","controls","className","operations","onChange","key","defaultActiveKey","activeKey","tabBarExtraContent","tab","_c","$RefreshReg$"],"sources":["/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\n\nimport SearchBar from \"./SearchBar\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\nimport PhotoGallery from \"./PhotoGallery\";\n\nconst { TabPane } = Tabs;\n\nfunction Home(props) {\n  const [posts, setPost] = useState([]);\n  const [activeTab, setActiveTab] = useState(\"image\");\n  const [searchOption, setSearchOption] = useState({\n    type: SEARCH_KEY.all,\n    keyword: \"\",\n  });\n\n  const handleSearch = (option) => {\n    const { type, keyword } = option;\n    setSearchOption({ type: type, keyword: keyword });\n  };\n\n  useEffect(() => {\n    fetchPost(searchOption);\n  }, [searchOption]);\n\n  const fetchPost = (option) => {\n    const { type, keyword } = option;\n    let url = \"\";\n\n    if (type === SEARCH_KEY.all) {\n      url = `${BASE_URL}/search`;\n    } else if (type === SEARCH_KEY.user) {\n      url = `${BASE_URL}/search?user=${keyword}`;\n    } else {\n      url = `${BASE_URL}/search?keywords=${keyword}`;\n    }\n\n    const opt = {\n      method: \"GET\",\n      url: url,\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`,\n      },\n    };\n\n    axios(opt)\n      .then((res) => {\n        if (res.status === 200) {\n          setPost(res.data);\n        }\n      })\n      .catch((err) => {\n        message.error(\"Load failed. Please Try later!\");\n        console.log(\"fetch posts failed: \", err.message);\n      });\n  };\n\n  const renderPosts = (type) => {\n    if (!posts || posts.length === 0) {\n      return <div>No data!</div>;\n    }\n    if (type === \"image\") {\n      const imageArr = posts\n        .filter((item) => item.type === \"image\")\n        .map((image) => {\n          return {\n            src: image.url,\n            user: image.user,\n            caption: image.message,\n            thumbnail: image.url,\n            thumbnailWidth: 300,\n            thumbnailHeight: 200,\n          };\n        });\n\n      return <PhotoGallery images={imageArr} />;\n    } else if (type === \"video\") {\n      return (\n        <Row gutter={32}>\n          {posts\n            .filter((post) => post.type === \"video\")\n            .map((post) => (\n              <Col span={8} key={post.url}>\n                <video src={post.url} controls={true} className=\"video-block\" />\n                <p>\n                  This is a test video from {post.user}: {post.message}\n                </p>\n              </Col>\n            ))}\n        </Row>\n      );\n    }\n  };\n\n  const operations = <Button>+New Post</Button>;\n  return (\n    <div className=\"home\">\n      <SearchBar handleSearch={handleSearch} />\n      <div className=\"display\">\n        <Tabs\n          onChange={(key) => setActiveTab(key)}\n          defaultActiveKey=\"image\"\n          activeKey={activeTab}\n          tabBarExtraContent={operations}\n        >\n          <TabPane tab=\"Images\" key=\"image\">\n            {renderPosts(\"image\")}\n          </TabPane>\n          <TabPane tab=\"Videos\" key=\"video\">\n            {renderPosts(\"video\")}\n          </TabPane>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n\nexport default Home;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}