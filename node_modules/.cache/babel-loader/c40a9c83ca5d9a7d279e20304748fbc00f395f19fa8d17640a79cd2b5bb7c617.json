{"ast":null,"code":"var _jsxFileName = \"/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\nimport SearchBar from \"./SearchBar\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport CreatePostButton from \"./CreatePostButton\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  TabPane\n} = Tabs;\nfunction Home(props) {\n  _s();\n  const [posts, setPost] = useState([]);\n  const [activeTab, setActiveTab] = useState(\"image\");\n  const [searchOption, setSearchOption] = useState({\n    type: SEARCH_KEY.all,\n    keyword: \"\"\n  });\n  const handleSearch = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    setSearchOption({\n      type: type,\n      keyword: keyword\n    });\n  };\n  useEffect(() => {\n    const {\n      type,\n      keyword\n    } = searchOption;\n    fetchPost(searchOption);\n  }, [searchOption]);\n  const fetchPost = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    let url = \"\";\n    if (type === SEARCH_KEY.all) {\n      url = `${BASE_URL}/search`;\n    } else if (type === SEARCH_KEY.user) {\n      url = `${BASE_URL}/search?user=${keyword}`;\n    } else {\n      url = `${BASE_URL}/search?keywords=${keyword}`;\n    }\n    const opt = {\n      method: \"GET\",\n      url: url,\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n      }\n    };\n    axios(opt).then(res => {\n      if (res.status === 200) {\n        setPost(res.data);\n      }\n    }).catch(err => {\n      message.error(\"Fetch posts failed!\");\n      console.log(\"fetch posts failed: \", err.message);\n    });\n  };\n  const renderPosts = type => {\n    if (!posts || posts.length === 0) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"No data!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }, this);\n    }\n    if (type === \"image\") {\n      const imageArr = posts.filter(item => item.type === \"image\").map(image => {\n        return {\n          postId: image.id,\n          src: image.url,\n          user: image.user,\n          caption: image.message,\n          thumbnail: image.url,\n          thumbnailWidth: 300,\n          thumbnailHeight: 200\n        };\n      });\n      return /*#__PURE__*/_jsxDEV(PhotoGallery, {\n        images: imageArr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }, this);\n    } else if (type === \"video\") {\n      return /*#__PURE__*/_jsxDEV(Row, {\n        gutter: 32,\n        children: posts.filter(post => post.type === \"video\").map(post => /*#__PURE__*/_jsxDEV(Col, {\n          span: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            src: post.url,\n            controls: true,\n            className: \"video-block\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [post.user, \": \", post.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 16\n          }, this)]\n        }, post.url, true, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 14\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 8\n      }, this);\n    }\n  };\n  const showPost = type => {\n    console.log(\"type -> \", type);\n    setActiveTab(type);\n    setTimeout(() => {\n      setSearchOption({\n        type: SEARCH_KEY.all,\n        keyword: \"\"\n      });\n    }, 3000);\n  };\n  const operations = /*#__PURE__*/_jsxDEV(CreatePostButton, {\n    onShowPost: showPost\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n      handleSearch: handleSearch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 6\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"display\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        onChange: key => setActiveTab(key),\n        defaultActiveKey: \"image\",\n        activeKey: activeTab,\n        tabBarExtraContent: operations,\n        children: [/*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Images\",\n          children: renderPosts(\"image\")\n        }, \"image\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 10\n        }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Videos\",\n          children: renderPosts(\"video\")\n        }, \"video\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 10\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 8\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 6\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 4\n  }, this);\n}\n_s(Home, \"wsMVT9R1VOpXPqcRFgod5krxwG0=\");\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useState","useEffect","Tabs","message","Row","Col","Button","axios","SearchBar","PhotoGallery","CreatePostButton","SEARCH_KEY","BASE_URL","TOKEN_KEY","jsxDEV","_jsxDEV","TabPane","Home","props","_s","posts","setPost","activeTab","setActiveTab","searchOption","setSearchOption","type","all","keyword","handleSearch","option","fetchPost","url","user","opt","method","headers","Authorization","localStorage","getItem","then","res","status","data","catch","err","error","console","log","renderPosts","length","children","fileName","_jsxFileName","lineNumber","columnNumber","imageArr","filter","item","map","image","postId","id","src","caption","thumbnail","thumbnailWidth","thumbnailHeight","images","gutter","post","span","controls","className","showPost","setTimeout","operations","onShowPost","onChange","key","defaultActiveKey","activeKey","tabBarExtraContent","tab","_c","$RefreshReg$"],"sources":["/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\n\nimport SearchBar from \"./SearchBar\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport CreatePostButton from \"./CreatePostButton\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\n\nconst { TabPane } = Tabs;\n\nfunction Home(props) {\n const [posts, setPost] = useState([]);\n const [activeTab, setActiveTab] = useState(\"image\");\n const [searchOption, setSearchOption] = useState({\n   type: SEARCH_KEY.all,\n   keyword: \"\"\n });\n\n const handleSearch = (option) => {\n   const { type, keyword } = option;\n   setSearchOption({ type: type, keyword: keyword });\n };\n\n useEffect(() => {\n   const { type, keyword } = searchOption;\n   fetchPost(searchOption);\n }, [searchOption]);\n\n const fetchPost = (option) => {\n   const { type, keyword } = option;\n   let url = \"\";\n\n   if (type === SEARCH_KEY.all) {\n     url = `${BASE_URL}/search`;\n   } else if (type === SEARCH_KEY.user) {\n     url = `${BASE_URL}/search?user=${keyword}`;\n   } else {\n     url = `${BASE_URL}/search?keywords=${keyword}`;\n   }\n\n   const opt = {\n     method: \"GET\",\n     url: url,\n     headers: {\n       Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n     }\n   };\n\n   axios(opt)\n     .then((res) => {\n       if (res.status === 200) {\n         setPost(res.data);\n       }\n     })\n     .catch((err) => {\n       message.error(\"Fetch posts failed!\");\n       console.log(\"fetch posts failed: \", err.message);\n     });\n };\n\n const renderPosts = (type) => {\n   if (!posts || posts.length === 0) {\n     return <div>No data!</div>;\n   }\n   if (type === \"image\") {\n     const imageArr = posts\n       .filter((item) => item.type === \"image\")\n       .map((image) => {\n         return {\n           postId: image.id,\n           src: image.url,\n           user: image.user,\n           caption: image.message,\n           thumbnail: image.url,\n           thumbnailWidth: 300,\n           thumbnailHeight: 200\n         };\n       });\n\n     return <PhotoGallery images={imageArr} />;\n   } else if (type === \"video\") {\n     return (\n       <Row gutter={32}>\n         {posts\n           .filter((post) => post.type === \"video\")\n           .map((post) => (\n             <Col span={8} key={post.url}>\n               <video src={post.url} controls={true} className=\"video-block\" />\n               <p>\n                 {post.user}: {post.message}\n               </p>\n             </Col>\n           ))}\n       </Row>\n     );\n   }\n };\n\n const showPost = (type) => {\n   console.log(\"type -> \", type);\n   setActiveTab(type);\n\n   setTimeout(() => {\n     setSearchOption({ type: SEARCH_KEY.all, keyword: \"\" });\n   }, 3000);\n };\n\n const operations = <CreatePostButton onShowPost={showPost} />;\n\n return (\n   <div className=\"home\">\n     <SearchBar handleSearch={handleSearch} />\n     <div className=\"display\">\n       <Tabs\n         onChange={(key) => setActiveTab(key)}\n         defaultActiveKey=\"image\"\n         activeKey={activeTab}\n         tabBarExtraContent={operations}\n       >\n         <TabPane tab=\"Images\" key=\"image\">\n           {renderPosts(\"image\")}\n         </TabPane>\n         <TabPane tab=\"Videos\" key=\"video\">\n           {renderPosts(\"video\")}\n         </TabPane>\n       </Tabs>\n     </div>\n   </div>\n );\n}\n\nexport default Home;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,IAAI,EAAEC,OAAO,EAAEC,GAAG,EAAEC,GAAG,EAAEC,MAAM,QAAQ,MAAM;AACtD,OAAOC,KAAK,MAAM,OAAO;AAEzB,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAOC,YAAY,MAAM,gBAAgB;AACzC,OAAOC,gBAAgB,MAAM,oBAAoB;AACjD,SAASC,UAAU,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/D,MAAM;EAAEC;AAAQ,CAAC,GAAGd,IAAI;AAExB,SAASe,IAAIA,CAACC,KAAK,EAAE;EAAAC,EAAA;EACpB,MAAM,CAACC,KAAK,EAAEC,OAAO,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EACrC,MAAM,CAACsB,SAAS,EAAEC,YAAY,CAAC,GAAGvB,QAAQ,CAAC,OAAO,CAAC;EACnD,MAAM,CAACwB,YAAY,EAAEC,eAAe,CAAC,GAAGzB,QAAQ,CAAC;IAC/C0B,IAAI,EAAEf,UAAU,CAACgB,GAAG;IACpBC,OAAO,EAAE;EACX,CAAC,CAAC;EAEF,MAAMC,YAAY,GAAIC,MAAM,IAAK;IAC/B,MAAM;MAAEJ,IAAI;MAAEE;IAAQ,CAAC,GAAGE,MAAM;IAChCL,eAAe,CAAC;MAAEC,IAAI,EAAEA,IAAI;MAAEE,OAAO,EAAEA;IAAQ,CAAC,CAAC;EACnD,CAAC;EAED3B,SAAS,CAAC,MAAM;IACd,MAAM;MAAEyB,IAAI;MAAEE;IAAQ,CAAC,GAAGJ,YAAY;IACtCO,SAAS,CAACP,YAAY,CAAC;EACzB,CAAC,EAAE,CAACA,YAAY,CAAC,CAAC;EAElB,MAAMO,SAAS,GAAID,MAAM,IAAK;IAC5B,MAAM;MAAEJ,IAAI;MAAEE;IAAQ,CAAC,GAAGE,MAAM;IAChC,IAAIE,GAAG,GAAG,EAAE;IAEZ,IAAIN,IAAI,KAAKf,UAAU,CAACgB,GAAG,EAAE;MAC3BK,GAAG,GAAI,GAAEpB,QAAS,SAAQ;IAC5B,CAAC,MAAM,IAAIc,IAAI,KAAKf,UAAU,CAACsB,IAAI,EAAE;MACnCD,GAAG,GAAI,GAAEpB,QAAS,gBAAegB,OAAQ,EAAC;IAC5C,CAAC,MAAM;MACLI,GAAG,GAAI,GAAEpB,QAAS,oBAAmBgB,OAAQ,EAAC;IAChD;IAEA,MAAMM,GAAG,GAAG;MACVC,MAAM,EAAE,KAAK;MACbH,GAAG,EAAEA,GAAG;MACRI,OAAO,EAAE;QACPC,aAAa,EAAG,UAASC,YAAY,CAACC,OAAO,CAAC1B,SAAS,CAAE;MAC3D;IACF,CAAC;IAEDN,KAAK,CAAC2B,GAAG,CAAC,CACPM,IAAI,CAAEC,GAAG,IAAK;MACb,IAAIA,GAAG,CAACC,MAAM,KAAK,GAAG,EAAE;QACtBrB,OAAO,CAACoB,GAAG,CAACE,IAAI,CAAC;MACnB;IACF,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,IAAK;MACd1C,OAAO,CAAC2C,KAAK,CAAC,qBAAqB,CAAC;MACpCC,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEH,GAAG,CAAC1C,OAAO,CAAC;IAClD,CAAC,CAAC;EACN,CAAC;EAED,MAAM8C,WAAW,GAAIvB,IAAI,IAAK;IAC5B,IAAI,CAACN,KAAK,IAAIA,KAAK,CAAC8B,MAAM,KAAK,CAAC,EAAE;MAChC,oBAAOnC,OAAA;QAAAoC,QAAA,EAAK;MAAQ;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAC5B;IACA,IAAI7B,IAAI,KAAK,OAAO,EAAE;MACpB,MAAM8B,QAAQ,GAAGpC,KAAK,CACnBqC,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAAChC,IAAI,KAAK,OAAO,CAAC,CACvCiC,GAAG,CAAEC,KAAK,IAAK;QACd,OAAO;UACLC,MAAM,EAAED,KAAK,CAACE,EAAE;UAChBC,GAAG,EAAEH,KAAK,CAAC5B,GAAG;UACdC,IAAI,EAAE2B,KAAK,CAAC3B,IAAI;UAChB+B,OAAO,EAAEJ,KAAK,CAACzD,OAAO;UACtB8D,SAAS,EAAEL,KAAK,CAAC5B,GAAG;UACpBkC,cAAc,EAAE,GAAG;UACnBC,eAAe,EAAE;QACnB,CAAC;MACH,CAAC,CAAC;MAEJ,oBAAOpD,OAAA,CAACN,YAAY;QAAC2D,MAAM,EAAEZ;MAAS;QAAAJ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAC3C,CAAC,MAAM,IAAI7B,IAAI,KAAK,OAAO,EAAE;MAC3B,oBACEX,OAAA,CAACX,GAAG;QAACiE,MAAM,EAAE,EAAG;QAAAlB,QAAA,EACb/B,KAAK,CACHqC,MAAM,CAAEa,IAAI,IAAKA,IAAI,CAAC5C,IAAI,KAAK,OAAO,CAAC,CACvCiC,GAAG,CAAEW,IAAI,iBACRvD,OAAA,CAACV,GAAG;UAACkE,IAAI,EAAE,CAAE;UAAApB,QAAA,gBACXpC,OAAA;YAAOgD,GAAG,EAAEO,IAAI,CAACtC,GAAI;YAACwC,QAAQ,EAAE,IAAK;YAACC,SAAS,EAAC;UAAa;YAAArB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAChExC,OAAA;YAAAoC,QAAA,GACGmB,IAAI,CAACrC,IAAI,EAAC,IAAE,EAACqC,IAAI,CAACnE,OAAO;UAAA;YAAAiD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzB,CAAC;QAAA,GAJae,IAAI,CAACtC,GAAG;UAAAoB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAKtB,CACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAEV;EACF,CAAC;EAED,MAAMmB,QAAQ,GAAIhD,IAAI,IAAK;IACzBqB,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEtB,IAAI,CAAC;IAC7BH,YAAY,CAACG,IAAI,CAAC;IAElBiD,UAAU,CAAC,MAAM;MACflD,eAAe,CAAC;QAAEC,IAAI,EAAEf,UAAU,CAACgB,GAAG;QAAEC,OAAO,EAAE;MAAG,CAAC,CAAC;IACxD,CAAC,EAAE,IAAI,CAAC;EACV,CAAC;EAED,MAAMgD,UAAU,gBAAG7D,OAAA,CAACL,gBAAgB;IAACmE,UAAU,EAAEH;EAAS;IAAAtB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;EAE7D,oBACExC,OAAA;IAAK0D,SAAS,EAAC,MAAM;IAAAtB,QAAA,gBACnBpC,OAAA,CAACP,SAAS;MAACqB,YAAY,EAAEA;IAAa;MAAAuB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACzCxC,OAAA;MAAK0D,SAAS,EAAC,SAAS;MAAAtB,QAAA,eACtBpC,OAAA,CAACb,IAAI;QACH4E,QAAQ,EAAGC,GAAG,IAAKxD,YAAY,CAACwD,GAAG,CAAE;QACrCC,gBAAgB,EAAC,OAAO;QACxBC,SAAS,EAAE3D,SAAU;QACrB4D,kBAAkB,EAAEN,UAAW;QAAAzB,QAAA,gBAE/BpC,OAAA,CAACC,OAAO;UAACmE,GAAG,EAAC,QAAQ;UAAAhC,QAAA,EAClBF,WAAW,CAAC,OAAO;QAAC,GADG,OAAO;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAExB,CAAC,eACVxC,OAAA,CAACC,OAAO;UAACmE,GAAG,EAAC,QAAQ;UAAAhC,QAAA,EAClBF,WAAW,CAAC,OAAO;QAAC,GADG,OAAO;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAExB,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAET;AAACpC,EAAA,CAvHQF,IAAI;AAAAmE,EAAA,GAAJnE,IAAI;AAyHb,eAAeA,IAAI;AAAC,IAAAmE,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}