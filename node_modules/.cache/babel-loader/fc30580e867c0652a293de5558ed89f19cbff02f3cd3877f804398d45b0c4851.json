{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Tabs,message,Row,Col,Button}from\"antd\";import axios from\"axios\";import SearchBar from\"./SearchBar\";import PhotoGallery from\"./PhotoGallery\";import CreatePostButton from\"./CreatePostButton\";import{SEARCH_KEY,BASE_URL,TOKEN_KEY}from\"../constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const{TabPane}=Tabs;function Home(props){const[posts,setPost]=useState([]);const[activeTab,setActiveTab]=useState(\"image\");const[searchOption,setSearchOption]=useState({type:SEARCH_KEY.all,keyword:\"\"});const handleSearch=option=>{const{type,keyword}=option;setSearchOption({type:type,keyword:keyword});};useEffect(()=>{const{type,keyword}=searchOption;fetchPost(searchOption);},[searchOption]);const fetchPost=option=>{const{type,keyword}=option;let url=\"\";if(type===SEARCH_KEY.all){url=\"\".concat(BASE_URL,\"/search\");}else if(type===SEARCH_KEY.user){url=\"\".concat(BASE_URL,\"/search?user=\").concat(keyword);}else{url=\"\".concat(BASE_URL,\"/search?keywords=\").concat(keyword);}const opt={method:\"GET\",url:url,headers:{Authorization:\"Bearer \".concat(localStorage.getItem(TOKEN_KEY))}};axios(opt).then(res=>{if(res.status===200){setPost(res.data);}}).catch(err=>{message.error(\"Fetch posts failed!\");console.log(\"fetch posts failed: \",err.message);});};const renderPosts=type=>{if(!posts||posts.length===0){return/*#__PURE__*/_jsx(\"div\",{children:\"No data!\"});}if(type===\"image\"){const imageArr=posts.filter(item=>item.type===\"image\").map(image=>{return{postId:image.id,src:image.url,user:image.user,caption:image.message,thumbnail:image.url,thumbnailWidth:300,thumbnailHeight:200};});return/*#__PURE__*/_jsx(PhotoGallery,{images:imageArr});}else if(type===\"video\"){return/*#__PURE__*/_jsx(Row,{gutter:32,children:posts.filter(post=>post.type===\"video\").map(post=>/*#__PURE__*/_jsxs(Col,{span:8,children:[/*#__PURE__*/_jsx(\"video\",{src:post.url,controls:true,className:\"video-block\"}),/*#__PURE__*/_jsxs(\"p\",{children:[post.user,\": \",post.message]})]},post.url))});}};const showPost=type=>{console.log(\"type -> \",type);setActiveTab(type);setTimeout(()=>{setSearchOption({type:SEARCH_KEY.all,keyword:\"\"});},3000);};const operations=/*#__PURE__*/_jsx(CreatePostButton,{onShowPost:showPost});return/*#__PURE__*/_jsxs(\"div\",{className:\"home\",children:[/*#__PURE__*/_jsx(SearchBar,{handleSearch:handleSearch}),/*#__PURE__*/_jsx(\"div\",{className:\"display\",children:/*#__PURE__*/_jsxs(Tabs,{onChange:key=>setActiveTab(key),defaultActiveKey:\"image\",activeKey:activeTab,tabBarExtraContent:operations,children:[/*#__PURE__*/_jsx(TabPane,{tab:\"Images\",children:renderPosts(\"image\")},\"image\"),/*#__PURE__*/_jsx(TabPane,{tab:\"Videos\",children:renderPosts(\"video\")},\"video\")]})})]});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","Tabs","message","Row","Col","Button","axios","SearchBar","PhotoGallery","CreatePostButton","SEARCH_KEY","BASE_URL","TOKEN_KEY","jsx","_jsx","jsxs","_jsxs","TabPane","Home","props","posts","setPost","activeTab","setActiveTab","searchOption","setSearchOption","type","all","keyword","handleSearch","option","fetchPost","url","concat","user","opt","method","headers","Authorization","localStorage","getItem","then","res","status","data","catch","err","error","console","log","renderPosts","length","children","imageArr","filter","item","map","image","postId","id","src","caption","thumbnail","thumbnailWidth","thumbnailHeight","images","gutter","post","span","controls","className","showPost","setTimeout","operations","onShowPost","onChange","key","defaultActiveKey","activeKey","tabBarExtraContent","tab"],"sources":["/Users/yuxuan/Desktop/projects/around-web/src/components/Home.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\n\nimport SearchBar from \"./SearchBar\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport CreatePostButton from \"./CreatePostButton\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\n\nconst { TabPane } = Tabs;\n\nfunction Home(props) {\n const [posts, setPost] = useState([]);\n const [activeTab, setActiveTab] = useState(\"image\");\n const [searchOption, setSearchOption] = useState({\n   type: SEARCH_KEY.all,\n   keyword: \"\"\n });\n\n const handleSearch = (option) => {\n   const { type, keyword } = option;\n   setSearchOption({ type: type, keyword: keyword });\n };\n\n useEffect(() => {\n   const { type, keyword } = searchOption;\n   fetchPost(searchOption);\n }, [searchOption]);\n\n const fetchPost = (option) => {\n   const { type, keyword } = option;\n   let url = \"\";\n\n   if (type === SEARCH_KEY.all) {\n     url = `${BASE_URL}/search`;\n   } else if (type === SEARCH_KEY.user) {\n     url = `${BASE_URL}/search?user=${keyword}`;\n   } else {\n     url = `${BASE_URL}/search?keywords=${keyword}`;\n   }\n\n   const opt = {\n     method: \"GET\",\n     url: url,\n     headers: {\n       Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n     }\n   };\n\n   axios(opt)\n     .then((res) => {\n       if (res.status === 200) {\n         setPost(res.data);\n       }\n     })\n     .catch((err) => {\n       message.error(\"Fetch posts failed!\");\n       console.log(\"fetch posts failed: \", err.message);\n     });\n };\n\n const renderPosts = (type) => {\n   if (!posts || posts.length === 0) {\n     return <div>No data!</div>;\n   }\n   if (type === \"image\") {\n     const imageArr = posts\n       .filter((item) => item.type === \"image\")\n       .map((image) => {\n         return {\n           postId: image.id,\n           src: image.url,\n           user: image.user,\n           caption: image.message,\n           thumbnail: image.url,\n           thumbnailWidth: 300,\n           thumbnailHeight: 200\n         };\n       });\n\n     return <PhotoGallery images={imageArr} />;\n   } else if (type === \"video\") {\n     return (\n       <Row gutter={32}>\n         {posts\n           .filter((post) => post.type === \"video\")\n           .map((post) => (\n             <Col span={8} key={post.url}>\n               <video src={post.url} controls={true} className=\"video-block\" />\n               <p>\n                 {post.user}: {post.message}\n               </p>\n             </Col>\n           ))}\n       </Row>\n     );\n   }\n };\n\n const showPost = (type) => {\n   console.log(\"type -> \", type);\n   setActiveTab(type);\n\n   setTimeout(() => {\n     setSearchOption({ type: SEARCH_KEY.all, keyword: \"\" });\n   }, 3000);\n };\n\n const operations = <CreatePostButton onShowPost={showPost} />;\n\n return (\n   <div className=\"home\">\n     <SearchBar handleSearch={handleSearch} />\n     <div className=\"display\">\n       <Tabs\n         onChange={(key) => setActiveTab(key)}\n         defaultActiveKey=\"image\"\n         activeKey={activeTab}\n         tabBarExtraContent={operations}\n       >\n         <TabPane tab=\"Images\" key=\"image\">\n           {renderPosts(\"image\")}\n         </TabPane>\n         <TabPane tab=\"Videos\" key=\"video\">\n           {renderPosts(\"video\")}\n         </TabPane>\n       </Tabs>\n     </div>\n   </div>\n );\n}\n\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}